:DOC-CONFIG:
# I based a lot of this config off of github user zzamboni's config
# Tangle by default to config.el, which is the most common case
#+property: header-args:emacs-lisp :tangle config.el
#+property: header-args :mkdirp yes :comments no
#+startup: fold
:END:

#+title: Doom Emacs configuration
#+author: Kirols Bakheat
#+email: kbakheat@gmail.com

This file gets tangled into [[file:config.el][config.el]], [[file:init.el][init.el]], and [[file:packages.el][packages.el]].

* Table of contents :TOC_3:noexport:
- [[#references][References]]
- [[#config-file-headers][Config file headers]]
- [[#doom-modules-config][Doom modules config]]
  - [[#input][Input]]
  - [[#completion][Completion]]
  - [[#ui][UI]]
  - [[#editor][Editor]]
  - [[#emacs][Emacs]]
  - [[#term][Term]]
  - [[#checkers][Checkers]]
  - [[#tools][Tools]]
  - [[#os][OS]]
  - [[#lang][Lang]]
  - [[#email][Email]]
  - [[#app][App]]
  - [[#config][Config]]
- [[#general-config][General config]]
  - [[#fonts-and-ligatures][Fonts and Ligatures]]
  - [[#org-mode-and-deft][Org mode and deft]]
    - [[#general-config-1][General config]]
    - [[#roam][Roam]]
    - [[#fragtog][Fragtog]]
    - [[#org-appear][Org-appear]]
    - [[#org-transclusion][Org-transclusion]]
    - [[#org-super-agenda][Org-super-agenda]]
    - [[#org-auto-tangle][Org-auto-tangle]]
    - [[#org-syntax-highlighting][Org syntax highlighting]]
  - [[#functions][Functions]]
    - [[#org-reformat][Org reformat]]
- [[#footers][Footers]]

* References
This is not a complete list. I have read though many people's configs and sometimes I forget to remember where I got a snippet or some inspiration from.

- [[https:https://github.com/zzamboni/dot-doom][zzamboni's doom emacs config]]
* Config file headers
We start by simply defining the standard headers used by the three files. These headers come from the initial files generated by =doom install=, and contain either some Emacs-LISP relevant indicators like =lexical-binding=, or instructions about the contents of the file.

#+html: <details><summary>init.el</summary>
#+begin_src emacs-lisp :tangle init.el
  ;;; init.el -*- lexical-binding: t; -*-

  ;; DO NOT EDIT THIS FILE DIRECTLY
  ;; This is a file generated from a literate programing source file
  ;; You should make any changes there and regenerate it from Emacs org-mode
  ;; using org-babel-tangle (C-c C-v t)

  ;; This file controls what Doom modules are enabled and what order they load
  ;; in. Remember to run 'doom sync' after modifying it!

  ;; NOTE Press 'SPC h d h' (or 'C-h d h' for non-vim users) to access Doom's
  ;;      documentation. There you'll find a "Module Index" link where you'll find
  ;;      a comprehensive list of Doom's modules and what flags they support.

  ;; NOTE Move your cursor over a module's name (or its flags) and press 'K' (or
  ;;      'C-c c k' for non-vim users) to view its documentation. This works on
  ;;      flags as well (those symbols that start with a plus).
  ;;
  ;;      Alternatively, press 'gd' (or 'C-c c d') on a module to browse its
  ;;      directory (for easy access to its source code).
#+end_src

#+results:

#+html: </details>

#+html: <details><summary>packages.el</summary>
#+begin_src emacs-lisp :tangle packages.el
  ;; -*- no-byte-compile: t; -*-
  ;;; $DOOMDIR/packages.el

  ;; DO NOT EDIT THIS FILE DIRECTLY
  ;; This is a file generated from a literate programing source file
  ;; You should make any changes there and regenerate it from Emacs org-mode
  ;; using org-babel-tangle (C-c C-v t)

  ;; To install a package with Doom you must declare them here and run 'doom sync'
  ;; on the command line, then restart Emacs for the changes to take effect -- or
  ;; use 'M-x doom/reload'.

  ;; To install SOME-PACKAGE from MELPA, ELPA or emacsmirror:
  ;;(package! some-package)

  ;; To install a package directly from a remote git repo, you must specify a
  ;; `:recipe'. You'll find documentation on what `:recipe' accepts here:
  ;; https://github.com/raxod502/straight.el#the-recipe-format
  ;;(package! another-package
  ;;  :recipe (:host github :repo "username/repo"))

  ;; If the package you are trying to install does not contain a PACKAGENAME.el
  ;; file, or is located in a subdirectory of the repo, you'll need to specify
  ;; `:files' in the `:recipe':
  ;;(package! this-package
  ;;  :recipe (:host github :repo "username/repo"
  ;;           :files ("some-file.el" "src/lisp/*.el")))

  ;; If you'd like to disable a package included with Doom, you can do so here
  ;; with the `:disable' property:
  ;;(package! builtin-package :disable t)

  ;; You can override the recipe of a built in package without having to specify
  ;; all the properties for `:recipe'. These will inherit the rest of its recipe
  ;; from Doom or MELPA/ELPA/Emacsmirror:
  ;;(package! builtin-package :recipe (:nonrecursive t))
  ;;(package! builtin-package-2 :recipe (:repo "myfork/package"))

  ;; Specify a `:branch' to install a package from a particular branch or tag.
  ;; This is required for some packages whose default branch isn't 'master' (which
  ;; our package manager can't deal with; see raxod502/straight.el#279)
  ;;(package! builtin-package :recipe (:branch "develop"))

  ;; Use `:pin' to specify a particular commit to install.
  ;;(package! builtin-package :pin "1a2b3c4d5e")

  ;; Doom's packages are pinned to a specific commit and updated from release to
  ;; release. The `unpin!' macro allows you to unpin single packages...
  ;;(unpin! pinned-package)
  ;; ...or multiple packages
  ;;(unpin! pinned-package another-pinned-package)
  ;; ...Or *all* packages (NOT RECOMMENDED; will likely break things)
  ;;(unpin! t)
#+end_src
#+html: </details>

#+html: <details><summary>config.el</summary>
#+begin_src emacs-lisp :tangle config.el
  ;;; $DOOMDIR/config.el -*- lexical-binding: t; -*-

  ;; DO NOT EDIT THIS FILE DIRECTLY
  ;; This is a file generated from a literate programing source file
  ;; You should make any changes there and regenerate it from Emacs org-mode
  ;; using org-babel-tangle (C-c C-v t)

  ;; Place your private configuration here! Remember, you do not need to run 'doom
  ;; sync' after modifying this file!

  ;; Some functionality uses this to identify you, e.g. GPG configuration, email
  ;; clients, file templates and snippets.
  ;; (setq user-full-name "John Doe"
  ;;      user-mail-address "john@doe.com")

  ;; Doom exposes five (optional) variables for controlling fonts in Doom. Here
  ;; are the three important ones:
  ;;
  ;; + `doom-font'
  ;; + `doom-variable-pitch-font'
  ;; + `doom-big-font' -- used for `doom-big-font-mode'; use this for
  ;;   presentations or streaming.
  ;;
  ;; They all accept either a font-spec, font string ("Input Mono-12"), or xlfd
  ;; font string. You generally only need these two:
  ;; (setq doom-font (font-spec :family "monospace" :size 12 :weight 'semi-light)
  ;;       doom-variable-pitch-font (font-spec :family "sans" :size 13))

  ;; There are two ways to load a theme. Both assume the theme is installed and
  ;; available. You can either set `doom-theme' or manually load a theme with the
  ;; `load-theme' function. This is the default:
  ;; (setq doom-theme 'doom-one)

  ;; If you use `org' and don't want your org files in the default location below,
  ;; change `org-directory'. It must be set before org loads!
  ;; (setq org-directory "~/org/")

  ;; This determines the style of line numbers in effect. If set to `nil', line
  ;; numbers are disabled. For relative line numbers, set this to `relative'.
  ;; (setq display-line-numbers-type t)

  ;; Here are some additional functions/macros that could help you configure Doom:
  ;;
  ;; - `load!' for loading external *.el files relative to this one
  ;; - `use-package!' for configuring packages
  ;; - `after!' for running code after a package has loaded
  ;; - `add-load-path!' for adding directories to the `load-path', relative to
  ;;   this file. Emacs searches the `load-path' when you load packages with
  ;;   `require' or `use-package'.
  ;; - `map!' for binding new keys
  ;;
  ;; To get information about any of these functions/macros, move the cursor over
  ;; the highlighted symbol at press 'K' (non-evil users must press 'C-c c k').
  ;; This will open documentation for it, including demos of how they are used.
  ;;
  ;; You can also try 'gd' (or 'C-c c d') to jump to their definition and see how
  ;; they are implemented.
#+end_src
#+html: </details>
* Doom modules config
This is the entirety of my =init.el= file. This configures all of the doom modules

#+html: <details><summary>Doom config</summary>
#+begin_src emacs-lisp :tangle init.el
  (doom!
#+end_src

** Input
#+html: <details><summary>input</summary>

I don't need any of these, and so I have these disabled.

#+begin_src emacs-lisp :tangle init.el
  :input
  ;;chinese
  ;;japanese
  ;;layout
#+end_src

#+html: </details
** Completion
#+html: <details><summary>completion</summary>

#+begin_src emacs-lisp :tangle init.el
  :completion
  (company
  +childframe)
  ;;helm
  ;;ido
  (ivy
  +childframe
  +fuzzy
  +icons
  +prescient)
#+end_src

#+html: </details

** UI
#+html: <details><summary>ui</summary>
#+begin_src emacs-lisp :tangle init.el
  :ui
#+end_src

I like the default emacs look a lot, so I pretty much just like to keep it the same here.

#+begin_src emacs-lisp :tangle init.el
  doom
  doom-dashboard
#+end_src

Emojis and unicode are nice since sometimes I open files with emojis or unicode or both in them.

#+begin_src emacs-lisp :tangle init.el
  (emoji
  +unicode
  +github)
  unicode
#+end_src

I find =doom-quit= cute so here it is.

#+begin_src emacs-lisp :tangle init.el
  doom-quit
#+end_src


These all in some way or another make code easier for me to read or make the UI of emacs display some information that I like.

#+begin_src emacs-lisp :tangle init.el
  hl-todo             ; highlight TODO/FIXME/NOTE, etc.
  indent-guides       ; highlights indent columns
  (ligatures
  +extra)
  modeline
  ophints
  (popup
  +defaults)
  tabs
  (treemacs
  +lsp)
  vc-gutter
  vi-tilde-fringe
  workspaces
  zen
#+end_src

I love how quick and easy =deft= makes it to take down a quick note that may or may not relate to the current file This makes it much easier to live in /emacs/ and not have to leave to another app.
#+begin_src emacs-lisp :tangle init.el
  deft
#+end_src

#+html: <details><summary>disabled ui modules</summary>
For some reason or another I don't have each of these enabled.
#+begin_src emacs-lisp :tangle init.el
  ;;hydra
  ;;minimap           ; show a map of the code on the side
  ;;nav-flash         ; blink cursor line after big motions
  ;;neotree           ; a project drawer, like NERDTree for vim
  ;;window-select     ; visually switch windows
#+end_src

#+html: </details
#+html: </details

** Editor
#+html: <details><summary>editor</summary>

There isn't really much to say here, most of these are self explanatory.
#+begin_src emacs-lisp :tangle init.el
  :editor
  (evil +everywhere)  ; come to the dark side, we have cookies
  file-templates      ; auto-snippets for empty files
  fold                ; (nigh) universal code folding
  (format +onsave)    ; automated prettiness
  ;;god               ; run Emacs commands without modifier keys
  ;;lispy             ; vim for lisp, for people who don't like vim
  multiple-cursors    ; editing in many places at once
  ;;objed               ; text object editing for the innocent
  ;;parinfer          ; turn lisp into python, sort of
  ;;rotate-text       ; cycle region at point between text candidates
  snippets            ; my elves. They type so I don't have to
  word-wrap           ; soft wrapping with language-aware indent
#+end_src

#+html: </details
** Emacs
#+html: <details><summary>emacs</summary>
Not much to say here other than that I

#+begin_src emacs-lisp :tangle init.el
  :emacs
  (dired      ; making dired pretty [functional]
  +icons
  +ranger)
  electric    ; smarter, keyword-based electric-indent
  (ibuffer    ; interactive buffer management
  +icons)
  (undo       ; persistent, smarter undo for your inevitable mistakes
  +tree)
  vc          ; version-control and Emacs, sitting in a tree
#+end_src
#+html: </details
** Term
#+html: <details><summary>Term</summary>
I think vterm is the best terminal for /emacs/ and is the only one I've liked so far.
#+begin_src emacs-lisp :tangle init.el
  :term
  ;;eshell
  ;;shell
  ;;term
  vterm
#+end_src

#+html: </details
** Checkers
#+html: <details><summary>checkers</summary>
I tend to make a lot of silly mistakes. I couldn't imagine trying to write anything without error checking

#+begin_src emacs-lisp :tangle init.el
  :checkers
  syntax
  (spell
  +aspell
  +everywhere)
  grammar
#+end_src

#+html: </details

** Tools
#+html: <details><summary>tools</summary>
These tools are so basic to my workflow that they can never be disabled. These are part of the reason I use /emacs/.

#+begin_src emacs-lisp :tangle init.el
  :tools
  debugger
  direnv
  (eval
  +overlay)
  lookup
  (lsp
  +peek)
  magit
  make
  pdf
#+end_src

These are the more generic tools that I don't need that often, but still like to keep around.
#+begin_src emacs-lisp :tangle init.el
  ein
  gist
#+end_src

These are just other tools that I have disabled.
#+begin_src emacs-lisp :tangle init.el
  ;;ansible
  ;;docker
  ;;editorconfig      ; let someone else argue about tabs vs spaces
  ;;prodigy           ; FIXME managing external services & code builders
  ;;rgb               ; creating color strings
  ;;taskrunner        ; taskrunner for all your projects
  ;;terraform         ; infrastructure as code
  ;;tmux              ; an API for interacting with tmux
  ;;upload            ; map local to remote projects via ssh/ftp
#+end_src

#+html: </details
** OS
#+html: <details><summary>os</summary>
Exactly the same as the default emacs config.

#+begin_src emacs-lisp :tangle init.el
  :os
  (:if IS-MAC macos)  ; improve compatibility with macOS
  ;;tty               ; improve the terminal Emacs experience
#+end_src
#+html: </details

** Lang
#+html: <details><summary>lang</summary>
I write code in many different languages, both because of school and because I like to. When I code, I usually prefer to have a language server, and so this section ends up making my config pretty heavy overall. I very often come here and enable or disable a language.

#+begin_src emacs-lisp :tangle init.el
  :lang
  ;;agda         ;;agda              ; types    ;;agda              ; types of types of types of types...
  ;;beancount         ; mind the GAAP
  (cc +lsp)           ; C > C++ == 1 might add +lsp
  ;;clojure           ; java with a lisp
  ;;common-lisp       ; if you've seen one lisp, you've seen them all
  ;;coq               ; proofs-as-programs
  ;;crystal           ; ruby at the speed of c
  ;;csharp            ; unity, .NET, and mono shenanigans
  ;;data              ; config/data formats
  ;;(dart +flutter)   ; paint ui and not much else
  ;;elixir            ; erlang done right
  ;;elm               ; care for a cup of TEA?
  emacs-lisp        ; drown in parentheses
  ;;erlang            ; an elegant language for a more civilized age
  ;;ess               ; emacs speaks statistics
  ;;factor
  ;;faust             ; dsp, but you get to keep your soul
  ;;fsharp            ; ML stands for Microsoft's Language
  ;;fstar             ; (dependent) types and (monadic) effects and Z3
  ;;gdscript          ; the language you waited for
  ;;(go +lsp)         ; the hipster dialect
  (haskell +dante)  ; a language that's lazier than I am
  ;;hy                ; readability of scheme w/ speed of python
  ;;idris             ; a language you can depend on
  json              ; At least it ain't XML
  ;;(java +meghanada) ; the poster child for carpal tunnel syndrome
  javascript        ; all(hope(abandon(ye(who(enter(here))))))
  ;;julia             ; a better, faster MATLAB
  ;;kotlin            ; a better, slicker Java(Script)
  (latex +cdlatex)             ; writing papers in Emacs has never been so fun
  ;;lean              ; for folks with too much to prove
  ;;ledger            ; be audit you can be
  ;;lua               ; one-based indices? one-based indices
  (markdown
  +grip)          ; writing docs for people to ignore
  ;;nim               ; python + lisp at the speed of c
  nix               ; I hereby declare "nix geht mehr!"
  ;;ocaml             ; an objective camel
  (org
  +brain
  +dragndrop
  +journal
  +noter
  +org-bullets
  +present
  +pretty
  +roam2
  )               ; organize your plain life in plain text
  ;;php               ; perl's insecure younger brother
  ;;plantuml          ; diagrams for confusing people more
  ;;purescript        ; javascript, but functional
  (python             ; beautiful is better than ugly
  +lsp
  +pyenv)
  ;;qt                ; the 'cutest' gui framework ever
  ;;racket            ; a DSL for DSLs
  ;;raku              ; the artist formerly known as perl6
  ;;rest              ; Emacs as a REST client
  ;;rst               ; ReST in peace
  ;;(ruby +rails)     ; 1.step {|i| p "Ruby is #{i.even? ? 'love' : 'life'}"}
  ;;rust              ; Fe2O3.unwrap().unwrap().unwrap().unwrap()
  ;;scala             ; java, but good
  ;;(scheme +guile)   ; a fully conniving family of lisps
  (sh                 ; she sells {ba,z,fi}sh shells on the C xor
  +fish)
  ;;sml
  ;;solidity          ; do you need a blockchain? No.
  ;;swift             ; who asked for emoji variables?
  ;;terra             ; Earth and Moon in alignment for performance.
  ;;web               ; the tubes
  yaml                ; JSON, but readable
  ;;zig               ; C, but simpler
#+end_src

#+html </details>
** Email
#+html: <details><summary>email</summary>

#+begin_src emacs-lisp :tangle init.el
  :email
  ;;(mu4e +gmail)
  ;;notmuch
  ;;(wanderlust +gmail)
#+end_src

#+html: </details
** App
#+html: <details><summary>app</summary>

#+begin_src emacs-lisp :tangle init.el
  :app
  calendar
  ;;emms
  ;;everywhere        ; *leave* Emacs!? You must be joking
  ;;irc               ; how neckbeards socialize
  ;;(rss +org)        ; emacs as an RSS reader
  ;;twitter           ; twitter client https://twitter.com/vnought
#+end_src

#+html: </details
** Config
#+html: <details><summary>config</summary>
#+begin_src emacs-lisp :tangle init.el
  :config
  literate
  (default +bindings +smartparens)
  )
#+end_src
#+html: </details
#+html: </details>

* General config

My personal info.
#+begin_src emacs-lisp
  (setq user-full-name "Kirols Bakheat"
        user-mail-address "kbakheat@gmail.com")
#+end_src

Keybindings for my mac.
#+begin_src emacs-lisp
  (cond (IS-MAC
         (setq mac-command-modifier       'meta
               mac-option-modifier        'meta
               mac-right-option-modifier  'alt
               mac-pass-control-to-system nil)))
#+end_src

Auto save my files.
#+begin_src emacs-lisp
  (setq auto-save-default t
        make-backup-files t)
#+end_src

Some bookmark related keybindings.
#+begin_src emacs-lisp
  (map! :leader
        (:prefix ("b". "buffer")
         :desc "List bookmarks" "L" #'list-bookmarks
         :desc "Save current bookmarks to bookmark file" "w" #'bookmark-save))
#+end_src

I find that relative line numbering makes some vim motions easier.
#+begin_src emacs-lisp
  (setq display-line-numbers-type 'relative)
#+end_src

I tend to have multiple programs open at once on a pretty small screen, so I like to have lines wrapped by default.
#+begin_src emacs-lisp
  (+global-word-wrap-mode +1)
#+end_src

I'm using the default =doom-one= theme here, and offer myself a quick way to switch to another theme.
#+begin_src emacs-lisp
  (setq doom-theme 'doom-one)
  (map! :leader
        :desc "Load new theme" "h t" #'counsel-load-theme)
#+end_src

=iedit= is a helpful way to quickly find variable occurences or change a variable's name.

#+begin_src emacs-lisp :tangle packages.el
  (package! iedit)
#+end_src
#+begin_src emacs-lisp
  (use-package! iedit
    :defer
    :config
    (set-face-background 'iedit-occurrence "Magenta")
    :bind
    ("C-d" . iedit-mode)
    )
#+end_src

I want to see the battery on my Mac because I hide the bar.
#+begin_src emacs-lisp
(unless (equal "Battery status not available"
               (battery))
  (display-battery-mode 1))
#+end_src

** Fonts and Ligatures
Fancy emojis, fonts, and beautiful ligatures. I remember stealing the ligatures code from someone but I don't remember where.
#+begin_src emacs-lisp
  (use-package! mixed-pitch
    :hook (org-mode . mixed-pitch-mode)
    :config
    (setq mixed-pitch-face 'variable-pitch))
  (use-package! emojify
    :hook (after-init . global-emojify-mode))

  (setq doom-font (font-spec :family "JetBrainsMono Nerd Font Mono" :size 16)
        doom-variable-pitch-font (font-spec :family "JetBrainsMono Nerd Font" :size 16)
        doom-unicode-font (font-spec :family "JuliaMono")
        doom-big-font (font-spec :family "JetBrainsMono Nerd Font" :size 24))
  (after! doom-themes
    (setq doom-themes-enable-bold t
          doom-themes-enable-italic t))
  (custom-set-faces!
    '(font-lock-comment-face :slant italic)
    '(font-lock-keyword-face :slant italic))


  (appendq! +ligatures-extra-symbols
            `(:checkbox      "â˜"
              :pending       "â—¼"
              :checkedbox    "â˜‘"
              :list_property "âˆ·"
              :em_dash       "â€”"
              :ellipses      "â€¦"
              :arrow_right   "â†’"
              :arrow_left    "â†"
              :title         "ð™"
              :subtitle      "ð™©"
              :author        "ð˜¼"
              :date          "ð˜¿"
              :property      "â˜¸"
              :options       "âŒ¥"
              :startup       "â»"
              :macro         "ð“œ"
              :html_head     "ðŸ…·"
              :html          "ðŸ…—"
              :latex_class   "ðŸ„»"
              :latex_header  "ðŸ…»"
              :beamer_header "ðŸ…‘"
              :latex         "ðŸ…›"
              :attr_latex    "ðŸ„›"
              :attr_html     "ðŸ„—"
              :attr_org      "â’ª"
              :begin_quote   "â"
              :end_quote     "âž"
              :caption       "â˜°"
              :header        "â€º"
              :results       "ðŸ ¶"
              :begin_export  "â©"
              :end_export    "âª"
              :properties    "âš™"
              :end           "âˆŽ"
              :priority_a   ,(propertize "âš‘" 'face 'all-the-icons-red)
              :priority_b   ,(propertize "â¬†" 'face 'all-the-icons-orange)
              :priority_c   ,(propertize "â– " 'face 'all-the-icons-yellow)
              :priority_d   ,(propertize "â¬‡" 'face 'all-the-icons-green)
              :priority_e   ,(propertize "â“" 'face 'all-the-icons-blue)))
  (set-ligatures! 'org-mode
    :merge t
    :checkbox      "[ ]"
    :pending       "[-]"
    :checkedbox    "[X]"
    :list_property "::"
    :em_dash       "---"
    :ellipsis      "..."
    :arrow_right   "->"
    :arrow_left    "<-"
    :title         "#+title:"
    :subtitle      "#+subtitle:"
    :author        "#+author:"
    :date          "#+date:"
    :property      "#+property:"
    :options       "#+options:"
    :startup       "#+startup:"
    :macro         "#+macro:"
    :html_head     "#+html_head:"
    :html          "#+html:"
    :latex_class   "#+latex_class:"
    :latex_header  "#+latex_header:"
    :beamer_header "#+beamer_header:"
    :latex         "#+latex:"
    :attr_latex    "#+attr_latex:"
    :attr_html     "#+attr_html:"
    :attr_org      "#+attr_org:"
    :begin_quote   "#+begin_quote"
    :end_quote     "#+end_quote"
    :caption       "#+caption:"
    :header        "#+header:"
    :begin_export  "#+begin_export"
    :end_export    "#+end_export"
    :results       "#+RESULTS:"
    :property      ":PROPERTIES:"
    :end           ":END:"
    :priority_a    "[#A]"
    :priority_b    "[#B]"
    :priority_c    "[#C]"
    :priority_d    "[#D]"
    :priority_e    "[#E]")
  (plist-put +ligatures-extra-symbols :name "â")
#+end_src

** Org mode and deft
I use Org mode for general writing and deft for quick notes. I'm pretty knew to org mode, having recently come from pandoc markdown for writing.

*** General config
#+begin_src emacs-lisp
  (setq org-directory "~/org/general")
  (setq deft-directory "~/org/deft")
  (add-hook! org-mode (electric-indent-local-mode -1))
  (after! org
    (setq
     org-insert-heading-respect-content nil
     org-catch-invisible-edits 'smart
     org-list-allow-alphabetical t))
#+end_src
*** Roam
#+begin_src emacs-lisp
 (use-package! org-roam
  ;; :ensure t
  ;; :init
  ;; (setq org-roam-v2-ack t)
  :config
  (setq org-roam-directory "~/org/roam"
    org-roam-completion-everywhere t)
  ;; ;; :bind (("C-c n l" . org-roam-buffer-toggle)
         ;; ;; ("C-c n f" . org-roam-node-find)
         ;; ;; ("C-c n i" . org-roam-node-insert)
         ;; ;; :map org-mode-map
         ;; ;; ("C-M-i"    . completion-at-point))
  ;; (org-roam-setup))
  )
#+end_src
*** Fragtog
As a student, I often write math in my org documents. I literally cannot live without the sort of preview that fragtog provides.
#+begin_src emacs-lisp :tangle packages.el
  (package! org-fragtog)
#+end_src
#+begin_src emacs-lisp
  (use-package! org-fragtog
    :after org
    :hook
        (org-mode . org-fragtog-mode))
#+end_src

*** Org-appear
#+begin_src emacs-lisp :tangle packages.el
  (package! org-appear)
#+end_src
#+begin_src emacs-lisp
  (use-package! org-appear
    :after org
    :hook (org-mode . org-appear-mode)
    :config (setq
             org-appear-autolinks t
             org-appear-autoentities t
             org-appear-autosubmarkers t ))
#+end_src
*** Org-transclusion
#+begin_src emacs-lisp :tangle packages.el
  (package! org-transclusion)
#+end_src
#+begin_src emacs-lisp
  (use-package! org-transclusion
    :after org-roam)
#+end_src
*** Org-super-agenda
#+begin_src emacs-lisp :tangle packages.el
  (package! org-super-agenda)
#+end_src
#+begin_src emacs-lisp
  (use-package! org-super-agenda
    :after org-agenda
    :config
    (setq org-super-agenda-groups '((:auto-dir-name t)))
    (org-super-agenda-mode))
#+end_src

*** Org-auto-tangle
#+begin_src emacs-lisp :tangle packages.el
  (package! org-auto-tangle)
#+end_src
#+begin_src emacs-lisp
  (use-package! org-auto-tangle
    :defer t
    :hook (org-mode . org-auto-tangle-mode)
    :config
    (setq org-auto-tangle-default t))
#+end_src
*** Org syntax highlighting
#+begin_src emacs-lisp
  (use-package! org
    :after ox-latex
    :config
    (add-to-list 'org-latex-packages-alist '("" "minted"))
    (setq org-latex-listings 'minted)
    (setq org-latex-compiler "xelatex")
    (setq org-latex-pdf-process
          (mapcar
           (lambda (s) (replace-regexp-in-string "%latex " "%latex -shell-escape " s)) org-latex-pdf-process))
    (setq org-src-fontify-natively t))
#+end_src

** Functions
*** Org reformat
Copied from [[https:https://github.com/zzamboni/dot-doom/blob/master/doom.org#reformatting-an-org-buffer][this]].
#+begin_src emacs-lisp
  (defun zz/org-reformat-buffer ()
    (interactive)
    (when (y-or-n-p "Really format current buffer? ")
      (let ((document (org-element-interpret-data (org-element-parse-buffer))))
        (erase-buffer)
        (insert document))))
#+end_src


* Footers
#+html: <details><summary>config.el</summary>
#+begin_src emacs-lisp
  (provide 'config)
  ;;; config.el ends here
#+end_src
#+html: </details>
#+html: <details><summary>init.el</summary>
#+begin_src emacs-lisp :tangle init.el
  (provide 'init)
  ;;; init.el ends here
#+end_src
#+html: </details>
#+html: <details><summary>init.el</summary>
#+begin_src emacs-lisp :tangle packages.el
  (provide 'packages)
  ;;; packages.el ends here
#+end_src
#+html: </details>
